webpackJsonp([3],{29:function(e,t,a){"use strict";function i(e){if(void 0===e)return"-";switch(e){case 0:return"已预定";case 1:return"已服务";case 2:return"已关闭";default:return"-"}}function n(e){if(void 0===e)return"-";switch(e){case 0:return"未授权";case 1:return"已授权";case 2:return"已取消";default:return"-"}}function o(e,t){var a="YYYY年MM月DD日";return void 0===e?"-":(void 0!==t&&(a=t),d(e).format(a))}function l(e,t){return void 0===e||void 0===t?"-":(t-e)/1e3}Object.defineProperty(t,"__esModule",{value:!0}),t.convertOrderStatus=i,t.convertAuthStatus=n,t.formatTime=o,t.convertExtTableMileage=l;var d=a(13)},586:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=a(4),o=i(n),l=a(14),d=i(l),s=a(1),r=i(s),u=a(3),c=i(u),f=a(2),h=i(f),m=a(0),v=i(m),p=a(9),g=i(p),S=a(26),y=i(S);a(27);var b=a(29),C=a(11),I=a(22),k=C.Form.Item,w=(C.Modal.confirm,C.Select.Option),N=(C.Select.OptGroup,C.DatePicker.MonthPicker,C.DatePicker.RangePicker,a(13),0),V=(0,d.default)("div",{}),A=(0,d.default)("br",{}),x=(0,d.default)("div",{}),F=(0,d.default)("br",{}),M=(0,d.default)(C.Button,{type:"primary"},"submit","立即使用"),L=(0,d.default)(C.Icon,{type:"plus"}),O=(0,d.default)("br",{}),T=(0,d.default)(w,{value:""},void 0,"全部"),z=(0,d.default)(w,{value:"0"},void 0,"已上架"),D=(0,d.default)(w,{value:"1"},void 0,"已下架"),H=(0,d.default)("h1",{},void 0,"质保-报修审核设置"),R=function(e){function t(){(0,r.default)(this,t);var a=(0,c.default)(this,e.call(this));return a.handleTableChange=function(e){a.state.pageSize=e.pageSize,a.state.page=e.current,a.state.query=a.props.form.getFieldsValue(),a.getByFilter().then(function(e){e.success})},a.handSubmit=function(){a.state.query=a.props.form.getFieldsValue(),a.getByFilter().then(function(e){e.success})},a.handleSchemeSubmit=function(){a.state.schemeName=a.props.form.getFieldsValue().schemeName,a.getSchemeByFilter().then(function(e){e.success})},a.handleReset=function(){a.props.form.resetFields(),a.setState({query:{}})},a.handleSchemeCancel=function(){a.setState({chooseSchemeVisible:!1})},a.handleSchemeOk=function(){a.setState({chooseSchemeVisible:!1});var e=a.state.selectedScheme,t=a.convertToSchemeShow(e);a.props.form.setFieldsValue({schemeInfo:t})},a.handleAddCancel=function(){a.props.form.resetFields(),a.setState({visible:!1})},a.convertToSchemeShow=function(e){return""+e.qaName+e.productName+e.expiresYear+"年期("+e.engineVolumeDown+"-"+e.engineVolumeUp+"L)"},a.handleAddOk=function(e){a.props.form.validateFieldsAndScroll(function(t){if(!t){if(a.state.info.schemeId=a.state.selectedScheme.id,a.state.editInfo&&(a.state.info.id=a.state.editInfo.id),a.state.info.auditLevelModels=a.props.form.getFieldValue("auditInfo"),a.state.info.remark=a.props.form.getFieldValue("remark"),"save"==e)a.state.info.status="1";else if("active"==e){if(!a.state.info.auditLevelModels)return void alert("请填写完整的审核配置信息");a.state.info.auditLevelModels.forEach(function(e){for(var t in e)if(!e[t]&&("roleCode"===t||"max"===t))return void alert("请填写完整的审核配置信息")}),a.state.info.status="0"}a.createOrUpdateAuditConfig().then(function(){a.setState({visible:!1}),a.getList()})}})},a.openCreateWarrantyAuditDialog=function(){a.props.form.resetFields(),a.setState({dialogName:"创建金额审核方案",editInfo:null,visible:!0})},a.openEditWarrantyAuditDialog=function(e){a.setState({editInfo:e,selectedScheme:e.schemeInfoModel,dialogName:"编辑金额审核方案",visible:!0})},a.chooseScheme=function(){a.state.chooseSchemeVisible=!0,a.getSchemeByFilter()},a.handleSchemeTableChange=function(e){a.state.schemePage.pageSize=e.pageSize,a.state.schemePage.page=e.current,a.getSchemeByFilter()},a.addAuditLevel=function(){var e=a.props.form,t=e.getFieldValue("keys");a.state.editInfo&&a.state.editInfo.auditLevelModels&&(N+=a.state.editInfo.auditLevelModels.length);var i=t.concat(N);N++,e.setFieldsValue({keys:i})},a.remove=function(e){var t=a.props.form,i=t.getFieldValue("keys");t.getFieldValue("auditInfo");t.setFieldsValue({keys:i.filter(function(t){return t!==e})})},a.changeAuditConfigStatus=function(e,t){a.state.id=e.id,a.state.status=t,a.state.schemeId=e.schemeId,a.changeStatus().then(function(){a.getList()})},a.openShowHistoryDialog=function(e){a.state.idForHistory=e.id,a.findHistory().then(function(e){a.setState({showHistoryVisible:!0})})},a.handleHistoryOk=function(){a.setState({showHistoryVisible:!1})},a.handleHistoryCancel=function(){a.setState({showHistoryVisible:!1})},a.state={info:{},query:{},status:"",visible:!1,chooseSchemeVisible:!1,showHistoryVisible:!1,addSearch:"",schemePage:{page:1,pageSize:6},schemeList:[],page:1,pageSize:10},a}return(0,h.default)(t,e),t.prototype.render=function(){var e=this,t=this.props.form,a=t.getFieldDecorator,i=t.getFieldValue,n=null,l=null;this.props._this&&this.props._this;var s=this;this.state.list&&(n={size:"small",total:this.state.list.totalNumber,current:this.state.list.currentIndex,pageSize:this.state.list.pageSize,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","50"],onShowSizeChange:function(e,t){},onChange:function(e,t){},showTotal:function(e){return"共"+e+"条"}}),this.state.schemeList&&(l={size:"small",total:this.state.schemeList.totalNumber,current:this.state.schemeList.currentIndex,pageSize:this.state.schemeList.pageSize,showQuickJumper:!0,pageSizeOptions:["10","20","50"],onShowSizeChange:function(e,t){},onChange:function(e,t){},showTotal:function(e){return"共"+e+"条"}});var r={type:"radio",onChange:function(e,t){},onSelect:function(e){s.state.selectedScheme=e}},u={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},c=[{title:"方案名称",dataIndex:"schemeName",key:"schemeName",render:function(t,a){var i=a.schemeInfoModel;return(0,d.default)("div",{},void 0,e.convertToSchemeShow(i))}},{title:"内容",dataIndex:"content",key:"content",render:function(e,t){for(var a=t.auditLevelModels,i=V,n=0;n<a.length;n++)i=(0,d.default)("div",{},void 0,i,(0,b.convertRoleCodeToRoleName)(a[n].roleCode)," ",a[n].min,"元-",a[n].max,"元",A);return i}},{title:"备注",dataIndex:"remark",key:"remark"},{title:"创建时间",dataIndex:"dateCreate",key:"dateCreate"},{title:"状态",dataIndex:"status",key:"status",render:function(e,t){return(0,d.default)("div",{},void 0,(0,b.convertWarrantyAuditConfigStatus)(t.status))}},{title:"操作",dataIndex:"option",width:200,key:"option",render:function(t,a){var i=void 0;"0"==a.status?i=(0,d.default)("a",{onClick:function(){return e.changeAuditConfigStatus(a,"1")}},void 0,"下架"):"1"==a.status&&(i=(0,d.default)("a",{onClick:function(){return e.changeAuditConfigStatus(a,"0")}},void 0,"上架"));var n=(0,d.default)("a",{onClick:function(){return e.openEditWarrantyAuditDialog(a)}},void 0,"修改"),o=(0,d.default)("a",{onClick:function(){return e.openShowHistoryDialog(a)}},void 0,"修改记录"),l=(0,d.default)("div",{},void 0,(0,d.default)("div",{},void 0,i," ",n," ",o));return(0,d.default)("div",{},void 0,l)}}],f=[{title:"方案名称",dataIndex:"productName",render:function(t,a){return(0,d.default)("div",{},void 0,e.convertToSchemeShow(a))}}],h=[{title:"方案名称",dataIndex:"productName",render:function(t,a){var i=a.schemeInfoModel;return(0,d.default)("div",{},void 0,e.convertToSchemeShow(i))}},{title:"内容",dataIndex:"content",key:"content",render:function(e,t){for(var a=t.auditLevelModels,i=x,n=0;n<a.length;n++)i=(0,d.default)("div",{},void 0,i,(0,b.convertRoleCodeToRoleName)(a[n].roleCode)," ",a[n].min,"元-",a[n].max,"元",F);return i}},{title:"备注",dataIndex:"remark",key:"remark"},{title:"创建时间",dataIndex:"dateCreate",key:"dateCreate"},{title:"状态",dataIndex:"status",key:"status",render:function(e,t){return(0,d.default)("div",{},void 0,(0,b.convertWarrantyAuditConfigStatus)(t.status))}}],m=function(e){var t=/^(\-)*(\d+).*$/;return"string"==typeof e?isNaN(Number(e))?"":e.replace(t,"$1$2"):"number"==typeof e?isNaN(e)?"":String(e).replace(t,"$1$2"):""},p=(0,d.default)(C.Button,{type:"primary",onClick:this.handSubmit},void 0,"搜索"),g=(0,d.default)(C.Button,{onClick:this.handleReset},void 0,"清除"),S=(0,d.default)(C.Button,{type:"primary",onClick:this.openCreateWarrantyAuditDialog},void 0,"创建"),y=void 0,w=void 0,N=void 0,R=void 0;if(this.state.roleList=[{key:"DSC_ZHIBAO_DIRECTOR",value:"主管"},{key:"DSC_ZHIBAO_MANAGER",value:"经理"},{key:"DSC_ZHIBAO_ADMINISTRATOR",value:"管理员"}],this.stateAlready){var B=new Array,_=void 0;if(this.state.editInfo){_=this.state.editInfo.auditLevelModels;for(var q=0;q<_.length;q++)B.push(q)}a("keys",{initialValue:B});var E=i("keys");R=E.map(function(t,n){return v.default.createElement(k,(0,o.default)({},u,{label:"角色",required:!1,key:t}),a("auditInfo["+t+"].roleCode",{initialValue:_&&_[t]?_[t].roleCode:"",rules:[{required:!0,message:"请选择角色"}]})((0,d.default)(I.RJSelect,{style:{width:"20%",marginRight:8},selectData:e.state.roleList})),"金额范围:",a("auditInfo["+t+"].min]",{initialValue:E[0]==t?0:+i("auditInfo["+E[n-1]+"].max")+1})((0,d.default)(C.InputNumber,{min:0,style:{width:"120",marginRight:8},placeholder:"最小金额",disabled:!0})),"元-",a("auditInfo["+t+"].max",{initialValue:_&&_[t]?_[t].max:null,rules:[{required:!0,message:"请输入金额"}]})((0,d.default)(C.InputNumber,{min:E[0]==t?1:+i("auditInfo["+E[n-1]+"].max")+2,style:{width:"120",marginRight:8},placeholder:"最大金额",formatter:m,parser:m,max:1e7})),"元",E.length>0?(0,d.default)(C.Icon,{className:"dynamic-delete-button",type:"minus-circle-o",onClick:function(){return e.remove(t)}}):null)}),y=(0,d.default)(C.Modal,{title:this.state.dialogName,width:800,visible:this.state.visible,onOk:this.handleAddOk,onCancel:this.handleAddCancel,footer:[(0,d.default)(C.Button,{disabled:"编辑金额审核方案"==this.state.dialogName,onClick:function(){return e.handleAddOk("save")}},"back","保存"),(0,d.default)(C.Popconfirm,{title:"确定吗?",onConfirm:function(){return e.handleAddOk("active")}},void 0,M)]},void 0,(0,d.default)(C.Form,{},void 0,v.default.createElement(k,(0,o.default)({},u,{label:"方案名称"}),a("schemeInfo",{initialValue:this.state.editInfo?this.convertToSchemeShow(this.state.editInfo.schemeInfoModel):null,rules:[{required:!0,message:"请选择方案名称"}]})((0,d.default)(C.Input,{style:{width:200},onClick:this.chooseScheme}))),R,v.default.createElement(k,(0,o.default)({},u,{label:"添加审核规则"}),(0,d.default)(C.Button,{type:"dashed",onClick:this.addAuditLevel,style:{width:200},disabled:!function(e,t){if(void 0===e)return!0;for(var a=0;a<t.length;a++){var i=e[t[a]];if(null==i.roleCode||null==i.min||null==i.max)return!1}return!0}(i("auditInfo"),E)},void 0,L)),v.default.createElement(k,(0,o.default)({},u,{label:"备注"}),a("remark",{initialValue:this.state.editInfo?this.state.editInfo.remark:""})((0,d.default)(C.Input,{type:"textarea",style:{width:300}}))))),w=(0,d.default)(C.Modal,{title:"选择方案",width:600,visible:this.state.chooseSchemeVisible,onOk:this.handleSchemeOk,onCancel:this.handleSchemeCancel},void 0,(0,d.default)(C.Form,{layout:"inline"},void 0,(0,d.default)(k,{label:"名称"},void 0,a("schemeName")((0,d.default)(C.Input,{style:{width:100}}))),(0,d.default)(C.Button,{type:"primary",onClick:this.handleSchemeSubmit},void 0,"搜索"),O,(0,d.default)("div",{className:"table-content"},void 0,(0,d.default)(C.Table,{columns:f,dataSource:this.state.schemeList.items,pagination:l,onChange:this.handleSchemeTableChange,rowSelection:r,bordered:!0})))),N=(0,d.default)(C.Modal,{title:"修改记录",width:800,visible:this.state.showHistoryVisible,onOk:this.handleHistoryOk,onCancel:this.handleHistoryCancel,footer:[]},void 0,(0,d.default)(C.Form,{layout:"inline"},void 0,(0,d.default)("div",{className:"table-content"},void 0,(0,d.default)(C.Table,{columns:h,dataSource:this.state.historyList?this.state.historyList.items:null,size:"small",bordered:!0}))))}var P=(0,d.default)("span",{},void 0,(0,d.default)(k,{label:"方案名称"},void 0,a("schemeName",{})((0,d.default)(C.Input,{style:{width:200},placeholder:"请输入"}))),(0,d.default)(k,{label:"状态"},void 0,a("status",{initialValue:""})((0,d.default)(C.Select,{placeholder:"请选择",style:{width:200}},void 0,T,z,D))),(0,d.default)(k,{},void 0,p),(0,d.default)(k,{},void 0,g),(0,d.default)(k,{},void 0,S),y,w,N);return this.stateAlready?(0,d.default)("div",{},void 0,H,(0,d.default)(C.Form,{layout:"inline",style:{padding:"20px"}},void 0,P),(0,d.default)("div",{},void 0,(0,d.default)("div",{className:"table-content"},void 0,(0,d.default)(C.Table,{columns:c,dataSource:this.state.list.items,rowKey:"productId",pagination:n,onChange:this.handleTableChange,bordered:!0})))):null},t}(y.default);R=C.Form.create()(R),g.default.render((0,d.default)("div",{},void 0,(0,d.default)(R,{})),document.querySelector("#content"))}},[586]);